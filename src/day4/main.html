<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>main.py</title>
  <link rel="stylesheet" href="../../pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>main.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h3>Part 1:</h3>
<p><paste in problem description here></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">NamedTuple</span><span class="p">,</span> <span class="n">TextIO</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>For example:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">test_part1</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h1>pycco needs this</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">example</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">Card 1: 41 48 83 86 17 | 83 86  6 31 17  9 48 53</span>
<span class="s2">Card 2: 13 32 20 16 61 | 61 30 68 82 17 32 24 19</span>
<span class="s2">Card 3:  1 21 53 59 44 | 69 82 63 72 16 21 14  1</span>
<span class="s2">Card 4: 41 92 73 84 69 | 59 84 76 51 58  5 54 83</span>
<span class="s2">Card 5: 87 83 26 28 32 | 88 30 70 12 93 22 82 36</span>
<span class="s2">Card 6: 31 18 13 56 72 | 74 77 10 23 35 67 36 11</span>
<span class="s2">#DIVIDER</span>
<span class="s2">&lt;end of problem description&gt;</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    cards = parse_cards(puzzle_input)</span>
<span class="s2">    win_count = (card_win_count(c) for c in cards)</span>
<span class="s2">    points = ((0 if wc == 0 else 2 ** (wc-1)) for wc in win_count)</span>

<span class="s2">    return sum(points)</span>
<span class="s2">#DIVIDER</span>

<span class="s2">#DIVIDER</span>
<span class="s2">def test_part2() -&gt; None:</span>
<span class="s2">#DIVIDER</span>
<span class="s2">    example = &quot;&quot;&quot;</span>\
<span class="n">Card</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">41</span> <span class="mi">48</span> <span class="mi">83</span> <span class="mi">86</span> <span class="mi">17</span> <span class="o">|</span> <span class="mi">83</span> <span class="mi">86</span>  <span class="mi">6</span> <span class="mi">31</span> <span class="mi">17</span>  <span class="mi">9</span> <span class="mi">48</span> <span class="mi">53</span>
<span class="n">Card</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">13</span> <span class="mi">32</span> <span class="mi">20</span> <span class="mi">16</span> <span class="mi">61</span> <span class="o">|</span> <span class="mi">61</span> <span class="mi">30</span> <span class="mi">68</span> <span class="mi">82</span> <span class="mi">17</span> <span class="mi">32</span> <span class="mi">24</span> <span class="mi">19</span>
<span class="n">Card</span> <span class="mi">3</span><span class="p">:</span>  <span class="mi">1</span> <span class="mi">21</span> <span class="mi">53</span> <span class="mi">59</span> <span class="mi">44</span> <span class="o">|</span> <span class="mi">69</span> <span class="mi">82</span> <span class="mi">63</span> <span class="mi">72</span> <span class="mi">16</span> <span class="mi">21</span> <span class="mi">14</span>  <span class="mi">1</span>
<span class="n">Card</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">41</span> <span class="mi">92</span> <span class="mi">73</span> <span class="mi">84</span> <span class="mi">69</span> <span class="o">|</span> <span class="mi">59</span> <span class="mi">84</span> <span class="mi">76</span> <span class="mi">51</span> <span class="mi">58</span>  <span class="mi">5</span> <span class="mi">54</span> <span class="mi">83</span>
<span class="n">Card</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">87</span> <span class="mi">83</span> <span class="mi">26</span> <span class="mi">28</span> <span class="mi">32</span> <span class="o">|</span> <span class="mi">88</span> <span class="mi">30</span> <span class="mi">70</span> <span class="mi">12</span> <span class="mi">93</span> <span class="mi">22</span> <span class="mi">82</span> <span class="mi">36</span>
<span class="n">Card</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">31</span> <span class="mi">18</span> <span class="mi">13</span> <span class="mi">56</span> <span class="mi">72</span> <span class="o">|</span> <span class="mi">74</span> <span class="mi">77</span> <span class="mi">10</span> <span class="mi">23</span> <span class="mi">35</span> <span class="mi">67</span> <span class="mi">36</span> <span class="mi">11</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>cards = parse_cards(io.StringIO(example))
  logging.debug(list(cards))</p>
<p># &gt; <code>""</code> results in  <code>...</code>.
  assert part1(io.StringIO(example)) == 13</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="o">&lt;</span><span class="n">end</span> <span class="n">of</span> <span class="n">problem</span> <span class="n">description</span><span class="o">&gt;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <h1>=== Part 1 Solution: ===</h1>
<p>class Card(NamedTuple):
    number: int
    winning_numbers: set[int]
    have_numbers: set[int]</p>
<p>line_pattern = re.compile(r&rdquo;Card +(\d+): ([\d ]+) \| ([\d ]+)&rdquo;)</p>
<p>def parse_cards(puzzle_input: TextIO) -&gt; Iterable[Card]:
    for line in puzzle_input:
        if m := line_pattern.fullmatch(line.strip()):
            yield Card(
                number=int(m.group(1)),
                winning_numbers={int(num) for num in m.group(2).split()},
                have_numbers={int(num) for num in m.group(3).split()},
            )
        else:
            raise ValueError(line)</p>
<p>def card_win_count(card: Card) -&gt; int:
    return len(card.winning_numbers &amp; card.have_numbers)</p>
<p>def part1(puzzle_input: TextIO) -&gt; int:
<solve part 1></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="n">card_counts</span><span class="o">.</span><span class="n">total</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h3>Part 2:</h3>
<p><paste in problem description here></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">with</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">puzzle_input</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 1:&quot;</span><span class="p">,</span> <span class="n">part1</span><span class="p">(</span><span class="n">puzzle_input</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>For example:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">with</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">puzzle_input</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 2:&quot;</span><span class="p">,</span> <span class="n">part2</span><span class="p">(</span><span class="n">puzzle_input</span><span class="p">))</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <h1>pycco needs this</h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>cards = parse_cards(io.StringIO(example))</p>
<p>card_it = iter(cards)
  assert card_copy_winnings(next(card_it)) == Counter([2, 3, 4, 5])
  assert card_copy_winnings(next(card_it)) == Counter([3, 4])
  assert card_copy_winnings(next(card_it)) == Counter([4, 5])</p>
<p># &gt; <code>""</code> results in  <code>...</code>.
  assert part2(io.StringIO(example)) == 30</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <h1>=== Part 2 Solution: ===</h1>
<p>def card_copy_winnings(card: Card) -&gt; Counter[int]:
    wins = card_win_count(card)
    return Counter(range(card.number + 1, card.number + wins + 1))</p>
<p>def counter_multiply(counter: Counter[int], multiplier: int) -&gt; Counter[int]:
    return Counter({k: count*multiplier for k, count in counter.items()})</p>
<p>def part2(puzzle_input: TextIO) -&gt; int:
    card_counts: Counter[int] = Counter()</p>
<pre><code>for card in parse_cards(puzzle_input):
    # Received the original card
    card_counts.setdefault(card.number, 0)
    card_counts[card.number] += 1

    won_cards = card_copy_winnings(card)
    card_counts += counter_multiply(won_cards, card_counts[card.number])
</code></pre>
<p><solve part 2></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Print out part 1 solution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Print out part 2 solution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
